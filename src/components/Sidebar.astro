---
const { activePage, } = Astro.props;

let pages = await Astro.glob('../articles/*.md')
let tags : string[] = []

pages.map( page => {
  page.frontmatter.tags && page.frontmatter.tags.forEach( (tag : string) => {
    tags.push(tag);
  })  
})

const tagsWithCount = tags.reduce( (a, b) => {
  a[b] = (a[b] || 0) +1
	return a
}, {})

let tagsSortedByCount = Object.keys(tagsWithCount).sort(function(a, b) {
  return tagsWithCount[b] - tagsWithCount[a];
});

tagsSortedByCount = tagsSortedByCount.slice(0,15).reverse()

---


<section class="sidebar">

  <nav id="nav">
  
    <ul class="main-nav">
      <li><a href="/">Home</a></li>
      <li><a href="/tag">All Topics</a></li>
      <li><a href="/trending">Trending Articles</a></li>
      <li><a href="/search">Search</a></li>
    </ul>
  

    <ul class="topics-nav">
      {
      tagsSortedByCount.map( tag => (
        <li>
          <a href={`/tag/${tag}`}>#{tag}</a>
        </li>
      ))
      }
    </ul>

  </nav>

</section>


<style>

.sidebar {
  display : none;

  position: fixed;
  inset : 0;
  z-index : 500;

  background-color: hsl( var(--clr-primary-7) );
  background-image: url(/assets/img/stacks.svg);
  background-size : cover;
}  

@media screen and (min-width : 850px) {
  .sidebar {
    display : block;
    position: static;
    order : 2;
    padding-block : 2rem;
  }
}

.sidebar nav {
  height : 100%;
  display : grid;
  place-items: center;
}

@media screen and (min-width : 850px) {
  .sidebar nav {
    align-items: start;
    gap : 5rem;
    padding-inline : 1.5rem;
  }
}

.main-nav {
  display : flex;
  flex-direction: column;
  align-items: center;
  gap : 2rem;
  font-size : var(--font-size-3);
}

@media screen and (min-width : 850px) {
  .main-nav {
    align-items: start;
    width : 100%;
    font-size : var(--font-size-2);
  }
}


.topics-nav {
  display : flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 2rem;
  font-size : var(--font-size-2);
}

.topics-nav li {
  width : fit-content
}

@media screen and (min-width : 850px) {
  .topics-nav {
    width : 100%;
    flex-direction: column;
    flex-wrap: nowrap;
    justify-content: flex-start;
    font-size : var(--font-size-1);
  }

  .topics-nav li {
    width : 100%;
  }
}

a {
  color : #ccc;
}

.more-topics-btn {
  display : inline-block;
  padding : 0.3rem 1rem;
  border : 1px solid #ccc;
}

</style>
      


<style is:global>



.mobile-menu-is-open .sidebar {
  display : block;
}

</style>



